select user_id, ltrim(substr(min(date), 6, 2), '0') || "/" || ltrim(substr(min(date),9,2), '0')  || "/" || ltrim(substr(min(date), 3,2), '0') as start_date, ltrim(substr(max(date), 6, 2), '0') || "/" || ltrim(substr(max(date),9,2), '0')  || "/" || ltrim(substr(max(date), 3,2), '0') as end_date, log as status, count(*) as length from (select users_log_id.*,(row_number() over (order by id) - row_number() over (partition by log order by id)) as grp from (select *, row_number() over () as id from users_log) as users_log_id ) users_log_id group by grp, log, user_id ORDER BY min(date), user_id;
